global:
  scrape_interval: {{ prometheus_scrape_interval }}
  evaluation_interval: {{ prometheus_evaluation_interval }}

scrape_configs:
  - job_name: "prometheus"
    static_configs:
      - targets: ["localhost:9090"]

  - job_name: 'cadvisor'
    static_configs:
      - targets:
        - '{{ hostvars[inventory_hostname]["ansible_host"] | default(inventory_hostname) }}:{{ cadvisor_port | default(8082) }}'


  - job_name: "node"
    static_configs:
{% for target in prometheus_targets %}
      - targets: ["{{ target.endpoint }}"]
        labels:
          instance: "{{ target.name }}"
{% endfor %}

